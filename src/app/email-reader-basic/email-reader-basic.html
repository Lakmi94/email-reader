<div>
  <h1 style="margin: 0;">Basic email reader</h1>
</div>

<div>
  <form #emailForm="ngForm" (ngSubmit)="addEmailToList(email)">
    <div class="form-group mb-3">
      <label>To</label>
      <input
        class="form-control"
        type="text"
        required
        name="emailTo"
        [(ngModel)]="email.to"
        #emailTo="ngModel"
        [ngClass]="emailTo.valid || emailTo.pristine ? '' : 'bg-danger'"
        pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
      />
      <div *ngIf="emailTo.touched && !emailTo.valid">
        <div *ngIf="emailTo.errors && emailTo.errors['required']">Email is required.</div>
        <div *ngIf="emailTo.errors && emailTo.errors['pattern']">
          Email does not match the required pattern.
        </div>
      </div>
    </div>
    <div class="form-group mb-3">
      <label>From</label>
      <input
        class="form-control"
        type="text"
        required
        name="emailFrom"
        [(ngModel)]="email.from"
        #emailFrom="ngModel"
        [ngClass]="emailFrom.valid || emailFrom.pristine ? '' : 'bg-danger'"
        pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
      />
      <div *ngIf="emailFrom.touched && !emailFrom.valid">
        <div *ngIf="emailFrom.errors && emailFrom.errors['required']">Email is required.</div>
        <div *ngIf="emailFrom.errors && emailFrom.errors['pattern']">
          Email does not match the required pattern.
        </div>
      </div>
    </div>
    <div class="form-group mb-3">
      <label>Subject</label>
      <input
        class="form-control"
        type="text"
        required
        minlength="10"
        name="emailSubject"
        pattern="^.{10,50}$"
        #emailSubject="ngModel"
        [(ngModel)]="email.subject"
        [ngClass]="emailSubject.valid || emailSubject.pristine ? '' : 'bg-danger'"
      />
      <div *ngIf="emailSubject.invalid && emailSubject.touched">
        <div *ngIf="emailSubject.errors?.['required']">Subject is required.</div>
        <div *ngIf="emailSubject.errors?.['minlength'] ">
          Subject must be at least 10 characters.
        </div>
        <div *ngIf="emailSubject.errors?.['pattern'] && emailSubject.value.length > 50">
          Subject cannot be longer than 50 characters.
        </div>
      </div>
    </div>

    <div class="form-group mb-3">
      <label>email body</label>
      <textarea
        class="form-control"
        name="emailBody"
        [(ngModel)]="email.body"
        #emailBody="ngModel"
      ></textarea>
    </div>
    <div class="buttons-container">
      <button class="send-button" type="submit" [disabled]="emailForm.invalid">
        <bi name="envelope" style="height: 30px"></bi>
        Send
      </button>

      <button class="send-button" type="reset" (click)="resetEmail()">
        <bi name="trash" style="height: 30px"></bi>Reset</button>
    </div>
    <div class="buttons" *ngIf="message">
      {{ message }}
    </div>
  </form>
  <div>
    <div *ngIf="emailList.length === 0" class="mt-5">The list of emails is empty</div>
  </div>
  <table class="table table-striped mt-5" *ngIf="emailList.length > 0">
    <thead>
      <tr>
        <th scope="col">To</th>
        <th scope="col">From</th>
        <th scope="col">Subject</th>
        <th scope="col">Body</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let mail of emailList" class="border-bottom">
        <td>{{ mail.to }}</td>
        <td>{{ mail.from }}</td>
        <td>{{ mail.subject }}</td>
        <td>{{ mail.body }}</td>
      </tr>
    </tbody>
  </table>
</div>
